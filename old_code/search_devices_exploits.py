import shodan

SHODAN_API_KEY = "myKey"

api = shodan.Shodan(SHODAN_API_KEY)

print('device search')
print('=================================================================================')
# Wrap the request in a try/ except block to catch errors
list_devices = ['webcam', 'router', 'Amazon Echo', 'printer', 'light']
for device in list_devices:
    try:
        # Search Shodan
        print('Searching for ' + device)
        print('=================================================================================')
        results = api.search(device)

        # Show the results
        print('Results found: {}'.format(results['total']))
        for result in results['matches']:
            print('IP: {}'.format(result['ip_str']))
            print('Port: {}'.format(result['port']))
            print(result['os'])
            # print(result['type'])
            print(result)
            print('')
    except shodan.APIError as e:
        print('Error: {}'.format(e))

print('exploit search')
print('=================================================================================')
# Wrap the request in a try/ except block to catch errors
list_exploits_type = ['dos', 'local', 'remote', 'shellcode', ' webapps']
for type in list_exploits_type:
    try:
        # Search Shodan
        print(type)
        print('=================================================================================')
        exploits = api.exploits.search('type:'+type)

        # Show the results
        print('Exploits found: {}'.format(exploits['total']))
        for exploit in exploits['matches']:
            print('CVE: {}'.format(exploit['cve']))
            print('Description: {}'.format(exploit['description']))
            print(exploit)
            print('')
    except Exception as e:
        print(e)
